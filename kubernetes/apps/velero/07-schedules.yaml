---
apiVersion: velero.io/v1
kind: Schedule
metadata:
  name: hourly-incremental-backup
  namespace: velero
  labels:
    velero.io/schedule-type: incremental
spec:
  schedule: "0 * * * *" # Every hour
  template:
    storageLocation: default
    ttl: 168h # 7 days
    includedNamespaces:
      - "*"
    excludedNamespaces:
      - velero
      - kube-system
    includeClusterResources: true
    # Whether pod volume file system backup should be used for all volumes by default.
    # If false, only PV snapshots will be taken.
    # Velero docs recommend setting this to false, since it's faster and more efficient.
    defaultVolumesToFsBackup: false
    hooks: {}
    metadata: {}
    snapshotVolumes: false
    labelSelector:
      matchExpressions:
        - key: velero.io/exclude-pvc
          operator: NotIn
          values: [ "true" ]
---
apiVersion: velero.io/v1
kind: Schedule
metadata:
  name: daily-full-backup
  namespace: velero
  labels:
    velero.io/schedule-type: full
spec:
  schedule: "0 2 * * *" # Daily at 2 AM
  template:
    storageLocation: truenas-daily
    ttl: 720h # 30 days
    includedNamespaces:
      - "*"
    excludedNamespaces:
      - velero
      - kube-system
    includeClusterResources: true
    defaultVolumesToFsBackup: false
    hooks: {}
    metadata: {}
    snapshotVolumes: false
    labelSelector:
      matchExpressions:
        - key: velero.io/exclude-pvc
          operator: NotIn
          values: [ "true" ]
---
apiVersion: velero.io/v1
kind: Schedule
metadata:
  name: weekly-archive-backup
  namespace: velero
  labels:
    velero.io/schedule-type: arch
spec:
  schedule: "0 3 * * 0" # Weekly on Sunday at 3 AM
  template:
    storageLocation: truenas-weekly
    ttl: 2160h # 90 days
    includedNamespaces:
      - "*"
    excludedNamespaces:
      - velero
      - kube-system
    includeClusterResources: true
    defaultVolumesToFsBackup: false
    hooks: {}
    metadata: {}
    snapshotVolumes: false
    labelSelector:
      matchExpressions:
        - key: velero.io/exclude-pvc
          operator: NotIn
          values: [ "true" ]
---
apiVersion: velero.io/v1
kind: Schedule
metadata:
  name: monthly-archive-backup
  namespace: velero
  labels:
    velero.io/schedule-type: archive
spec:
  schedule: "0 4 1 * *" # 1st day of each month at 4 AM
  template:
    storageLocation: truenas-monthly
    ttl: 8760h # 1 year
    includedNamespaces:
      - "*"
    excludedNamespaces:
      - velero
      - kube-system
    includeClusterResources: true
    defaultVolumesToFsBackup: false
    hooks: {}
    metadata: {}
    snapshotVolumes: false
    labelSelector:
      matchExpressions:
        - key: velero.io/exclude-pvc
          operator: NotIn
          values: [ "true" ]

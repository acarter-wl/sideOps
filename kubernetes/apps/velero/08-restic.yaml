# ---
# apiVersion: apps/v1
# kind: DaemonSet
# metadata:
#   name: restic
#   namespace: velero
# spec:
#   selector:
#     matchLabels:
#       name: restic
#   template:
#     metadata:
#       labels:
#         name: restic
#     spec:
#       serviceAccountName: velero
#       securityContext:
#         runAsUser: 0
#       containers:
#         - name: restic
#           image: velero/velero:v1.12.0
#           command:
#             - /velero
#           args:
#             - node-agent
#             - server
#           volumeMounts:
#             - name: host-pods
#               mountPath: /host_pods
#               mountPropagation: HostToContainer
#             - name: scratch
#               mountPath: /scratch
#             - name: cloud-credentials
#               mountPath: /credentials
#           env:
#             - name: NODE_NAME
#               valueFrom:
#                 fieldRef:
#                   fieldPath: spec.nodeName
#             - name: VELERO_NAMESPACE
#               valueFrom:
#                 fieldRef:
#                   fieldPath: metadata.namespace
#             - name: AWS_SHARED_CREDENTIALS_FILE
#               value: /credentials/cloud
#             - name: SCRATCH_DIR
#               value: /scratch
#           resources:
#             requests:
#               cpu: 125m
#               memory: 128Mi
#             limits:
#               cpu: 1000m
#               memory: 512Mi
#       volumes:
#         - name: host-pods
#           hostPath:
#             path: /var/lib/kubelet/pods
#         - name: scratch
#           emptyDir: {}
#         - name: cloud-credentials
#           secret:
#             secretName: cloud-credentials

loki:
  # Global settings
  auth_enabled: false # Set to false if not using Loki authentication

  # Service Type (ClusterIP is common for internal access, e.g., from Grafana in the same cluster)
  service:
    type: ClusterIP
    ports:
      http: 3100
      grpc: 9095

  # Storage Configuration (S3 Backend)
  storage:
    type: s3 # Specify S3 as the storage backend
    bucketNames:
      chunks: loki
      ruler: loki #ur S3 bucket name for ruler if enabled (recommended separate)
      admin: loki #Your S3 bucket name for admin if needed (recommended separate)

# Configuration for Index and Chunk storage in S3
storage_config:
  aws:
    s3:
      minio:
        s3: "http://nDHdq3UjrbAw0R6k:rjAu8hYf24ra3kzsEApzhsjfqUG00LPt@minio.storage.svc.cluster.local:9000/loki"
        s3forcepathstyle: true


  schemaConfig:
    configs:
      - from: 2020-10-27 # Start date for this schema config
        store: boltdb-shipper # Index store (can be boltdb-shipper for S3)
        object_store: s3 # Chunk store
        schema: v11 # Schema version
        index:
          prefix: index_ # Prefix for index objects in S3
          period: 24h # How often to create new index files

  limits_config:
    enforce_metric_name: false
    reject_old_samples: true
    reject_old_samples_max_age: 168h # 7 days example retention - AD

  # S3 storage configuration using named_stores pattern from the github issue
  boltdbShipper:
    sharedStore: s3 # Boltdb-shipper stores index files in S3
    activeindexdirectory: /var/loki/index
  compactor:
    workingDirectory: /var/loki/compactor # Local working directory
    sharedStore: s3

replicaCount: 1

deploymentMode: SimpleScalable

loki:
    auth_enabled: false
    common:
        # Force a specific tenant ID
        ring:
            kvstore:
                store: memberlist
                schemaConfig:
                    configs:
                        - from: "2024-04-01"
                          store: tsdb
                          object_store: s3
                          schema: v13
                          index:
                            prefix: loki_index_
                            period: 24h
                storage:
                    type: s3
                    bucketNames:
                        chunks: ceph-chunks
                        ruler: ceph-ruler
                        admin: ceph-admin
                    s3:
                        endpoint: http://rook-ceph-rgw-ceph-objectstore.rook-ceph.svc.cluster.local
                        region: us-east-1
                        access_key_id: S7RFA0US3ZM69ZVEIKRN
                        secret_access_key: b5JsiA2vyY7UHAf2XqRTpo08soE2g0cBWvXiOh6J
                        signatureVersion: v2
                        s3ForcePathStyle: true
                        insecure: true
                        http_config: {}
                limits_config:
                    # Add retention period
                    retention_period: 720h
                    # Consider other limits
                    max_query_parallelism: 128
                    max_query_length: 721h
                    max_streams_per_user: 10000
                ingester:
                    chunk_encoding: snappy
                querier:
                    query_ingesters_within: 3h
                    max_concurrent: 10
            instance_interface_names:
                - lo
                - eth.*
            ingester:
                instance_limits:
                    max_global_series_per_user: 1000000
                    max_global_series_per_metric: 100000
                ring:
                    heartbeat_period: 10s
                    replication_factor: 3
compactor:
    persistence:
        enabled: true
        mountPath: /var/loki/compactor
        accessModes:
            - ReadWriteOnce
        size: 20Gi
        storageClass: ceph-block
lokiCanary:
    enabled: true
backend:
    replicas: 2
read:
    replicas: 2
write:
    replicas: 3
minio:
    enabled: false
# Grafana datastore
grafana:
    enabled: false
# Environment variables for all containers
extraEnvFrom:
    - secretRef:
        name: loki-s3-creds
# Resource requirements
resources:
    requests:
        cpu: 100m
        memory: 512Mi
    limits:
        cpu: 500m
        memory: 2Gi
# Add tolerations
tolerations:
    - operator: Exists

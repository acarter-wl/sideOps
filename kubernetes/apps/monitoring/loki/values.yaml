loki:
  auth_enabled: false
  useTestSchema: true  # This enables the test schema
  config: |
    auth_enabled: false
    server:
      http_listen_port: 3100
    common:
      storage:
        s3:
          s3: s3://minio.storage:9000/loki
          s3forcepathstyle: true
    schema_config:
      configs:
        - from: 2020-10-24
          store: boltdb-shipper
          object_store: s3
          schema: v11
          index:
            prefix: loki_index_
            period: 24h
    storage_config:
      aws:
        s3: s3://minio.storage:9000/loki
        s3forcepathstyle: true
        bucketnames: loki
        region: us-east-1
        insecure: true
      boltdb_shipper:
        shared_store: s3
  image:
    tag: 2.9.3
  env:
    - name: AWS_ACCESS_KEY_ID
      valueFrom:
        secretKeyRef:
          name: iam-loki-s3
          key: AWS_ACCESS_KEY_ID
    - name: AWS_SECRET_ACCESS_KEY
      valueFrom:
        secretKeyRef:
          name: iam-loki-s3
          key: AWS_SECRET_ACCESS_KEY

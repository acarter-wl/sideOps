deploymentMode: SimpleScalable

loki:
    auth_enabled: false
    commonConfig:
        ring:
            kvstore:
                store: memberlist
    limits_config:
        retention_period: 17520h
        max_query_parallelism: 128
        max_query_length: 721h
        max_streams_per_user: 10000
    ingester:
        chunk_encoding: snappy
    querier:
        query_ingesters_within: 3h
        max_concurrent: 10
    distributor: {}
    frontend: {}
    storage_config:
        aws:
            s3:
                bucket: ceph-chunks
                region: us-east-1
                endpoint: http://rook-ceph-rgw-ceph-objectstore.monitoring.svc.cluster.local
                signatureVersion: v4
                insecure: true
                s3ForcePathStyle: true
                http_config: {}
        boltdb_shipper:
            active_index_directory: /data/loki/index
            cache_location: /data/loki/index_cache
            shared_store: s3
        cache_config:
            enable_fifocache: true
            fifocache:
                max_size_bytes: 1073741824  # 1GB
                ttl: 24h
        tsdb_shipper:
            active_index_directory: /data/loki/tsdb
            cache_location: /data/loki/tsdb-cache
            shared_store: s3
    chunk_store_config:
        chunk_cache_config:
            enable_fifocache: true
            fifocache:
                max_size_bytes: 1073741824  # 1GB
                ttl: 24h
    compactor:
        working_directory: /data/loki/compactor
        shared_store: s3
        retention_enabled: true
        retention_delete_delay: 2h
        delete_request_store: s3
    schema_config:
        configs:
            - from: "2024-04-01"
              store: tsdb
              object_store: s3
              schema: v13
              index:
                prefix: loki_index_
                period: 24h

compactor:
    persistence:
        enabled: true
        mountPath: /var/loki/compactor
        accessModes:
            - ReadWriteOnce
        size: 20Gi
        storageClass: ceph-block

lokiCanary:
    enabled: true
backend:
    replicas: 2
read:
    replicas: 2
write:
    replicas: 3
minio:
    enabled: false
grafana:
    enabled: false
extraEnvFrom:
    - secretRef:
        name: loki-s3-creds

resources:
    requests:
        cpu: 100m
        memory: 512Mi
    limits:
        cpu: 500m
        memory: 2Gi

tolerations:
    - operator: Exists

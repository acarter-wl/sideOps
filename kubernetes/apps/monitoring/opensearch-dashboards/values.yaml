opensearchHosts: "https://opensearch-cluster-master:9200"

# For homelab usage, we set basic resources
resources:
  requests:
    cpu: "0.3"
    memory: "512Mi"
  limits:
    cpu: "1"
    memory: "1Gi"

# Configure network settings
service:
  type: ClusterIP
  port: 5601

# Configure dashboard security to work with the OpenSearch security settings
opensearchAccount:
  secret: opensearch-cluster-master-credentials

# Basic environment variables
extraEnvs:
  - name: "SERVER_BASEPATH"
    value: ""
  - name: "OPENSEARCH_SSL_VERIFICATIONMODE"
    value: "none"
  - name: "OPENSEARCH_DASHBOARDS_USERNAME"
    valueFrom:
      secretKeyRef:
        name: opensearch-cluster-master-credentials
        key: username
  - name: "OPENSEARCH_DASHBOARDS_PASSWORD"
    valueFrom:
      secretKeyRef:
        name: opensearch-cluster-master-credentials
        key: password

# For ingress configuration - fixed format for the chart
ingress:
  enabled: true
  annotations:
    kubernetes.io/ingress.class: nginx
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  hosts:
    - host: dashboards.your-domain.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: opensearch-dashboards-tls
      hosts:
        - dashboards.your-domain.com

config:
  opensearch_dashboards.yml: |
    server.host: "0.0.0.0"
    opensearch.hosts: ["https://opensearch-cluster-master:9200"]
    opensearch.username: "admin"
    opensearch.password: "${OPENSEARCH_PASSWORD}"
    opensearch.ssl.verificationMode: certificate
    server.ssl.enabled: false  # No HTTPS for internal traffic
    opensearch.ignoreVersionMismatch: true
    telemetry.optIn: false
    telemetry.enabled: false

extraVolumes:
  - name: dashboards-certs
    secret:
      secretName: opensearch-dashboards-tls
extraVolumeMounts:
  - name: dashboards-certs
    mountPath: /usr/share/opensearch-dashboards/config/certs
    readOnly: true
# Add custom dashboards to have pre-configured upon deployment
dashboardImport:
  enabled: false
  # We'll enable this after getting the basic setup working
  # timeout: 60
  # dashboards:
  #   - title: "Kubernetes Logs Overview"
  #     file: "/dashboards/kubernetes-logs.ndjson"

  # Set replicaCount to 1 for homelab environments
replicaCount: 1

# Configure persistent storage to save dashboard configurations
persistence:
  enabled: true
  storageClass: "ceph-block"
  accessModes:
    - ReadWriteOnce
  size: 20Gi

# Security context for better pod security
podSecurityContext:
  fsGroup: 1000

securityContext:
  capabilities:
    drop:
      - ALL
  runAsNonRoot: true
  runAsUser: 1000

# Service account settings
serviceAccount:
  create: true
  annotations: {}

# Enable Prometheus metrics
serviceMonitor:
  enabled: true
  labels:
    release: kube-prometheus-stack
  interval: 1m
  scrapeTimeout: 30s

# Pod annotations for better integration
podAnnotations:
  prometheus.io/scrape: "true"
  prometheus.io/port: "5601"

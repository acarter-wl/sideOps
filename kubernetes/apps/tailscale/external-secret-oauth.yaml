apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  # name of the ExternalSecret
  name: tailnet
  # Namespace where the ExternalSecret and the target Secret will be created
  namespace: tailscale
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: k8s # Use the 'k8s' ClusterSecretStore
  target:
    # The name of the Kubernetes Secret to create in the 'tailscale' namespace
    name: operator-oauth
    creationPolicy: Owner
  data:
    - secretKey: client_id # Key name in the resulting K8s Secret
      remoteRef:
        # 1password-entry-name
        key: "tailnet" # Name of the item in 1Password
        # 1password-field-name
        property: client_id # Name of the field for the client ID
    - secretKey: client_secret # Key name in the resulting K8s Secret
      remoteRef:
        # 1password-entry-name
        key: "tailnet" # Name of the item in 1Password
        # 1password-field-name
        property: client_secret # Name of the field for the client secret

apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: k8s
spec:
  provider:
    onepassword:
      connectHost: http://onepassword-connect:8080
      vaults:
        k8s: 1 # look in this vault first
      auth:
        secretRef:
          connectTokenSecretRef:
            name: onepassword-connect-token
            key: token
            namespace: external-secrets

###https://dev.to/3deep5me/using-1password-with-external-secrets-operator-in-a-gitops-way-4lo4
#example secret
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   # name of the ExternalSecret & Secret which gets created
#   name: scaleway-credentials
# spec:
#   secretStoreRef:
#     kind: ClusterSecretStore
#     name: dev
#   target:
#     creationPolicy: Owner
#   data:
#   - secretKey: accessKeyId
#     remoteRef:
#       # 1password-entry-name
#       key: "Scaleway Credentials"
#       # 1password-field
#       property: accessKeyId
#   - secretKey: secretKey
#     remoteRef:
#       # 1password-entry-name
#       key: "Scaleway Credentials"
#       # 1password-field
#       property: secretKey

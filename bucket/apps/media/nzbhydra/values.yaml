nameOverride: "nzbhydra"
fullnameOverride: "nzbhydra"
podLabels:
  app: nzbhydra
controllers:
  main:
    enabled: true
    type: deployment
    replicas: 1
    strategy: Recreate
    containers:
      main:
        enabled: true
        image:
          repository: linuxserver/nzbhydra2
          tag: latest
          pullPolicy: IfNotPresent
        env:
          PUID: "0"
          PGID: "0"
          TZ: "America/Chicago"
          # Using UMASK to ensure new files have appropriate permissions
          UMASK: "022"
        ports:
          - containerPort: 5076
            name: http
            protocol: TCP
        # Remove the securityContext from the container level
        # securityContext block removed here
        resources:
          limits:
            cpu: 1000m
            memory: 2Gi
          requests:
            cpu: 100m
            memory: 256Mi
        probes:
          liveness:
            enabled: true
            spec:
              httpGet:
                path: /
                port: 5076
              initialDelaySeconds: 30
              periodSeconds: 10
              timeoutSeconds: 1
              failureThreshold: 5
          readiness:
            enabled: true
            spec:
              httpGet:
                path: /
                port: 5076
              initialDelaySeconds: 15
              periodSeconds: 10
              timeoutSeconds: 1
              failureThreshold: 3
          startup:
            enabled: true
            spec:
              httpGet:
                path: /
                port: 5076
              initialDelaySeconds: 60
              periodSeconds: 10
              timeoutSeconds: 5
              failureThreshold: 30
service:
  main:
    controller: main
    ports:
      http:
        port: 5076
        targetPort: 5076
ingress:
  main:
    enabled: true
    className: internal
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-production
    hosts:
      - host: nzbhydra.wakkalabs.com
        paths:
          - path: /
            pathType: Prefix
            service:
              name: nzbhydra
              port: 5076
    tls:
      - secretName: nzbhydra-tls
        hosts:
          - nzbhydra.wakkalabs.com
# Update the pod-level securityContext to use root
securityContext:
  runAsUser: "0"
  runAsGroup: "0"
  fsGroup: "0"
  fsGroupChangePolicy: "OnRootMismatch"
persistence:
  config:
    enabled: true
    type: persistentVolumeClaim
    existingClaim: nzbhydra-config
  downloads:
    enabled: true
    type: persistentVolumeClaim
    existingClaim: downloads-ceph
  media:
    enabled: true
    type: persistentVolumeClaim
    existingClaim: nfs-media
additionalContainers: {}
additionalVolumes: []

loki:
  auth_enabled: false
  config: 
    common:
      path_prefix: /var/loki
      replication_factor: 1
      ring:
        kvstore:
          store: inmemory
    schema_config:
      configs:
        - from: "2022-01-01"
          store: tsdb
          object_store: s3
          schema: v12
          index:
            period: 24h
            prefix: loki_index_
    server:
      http_listen_port: 3100
    storage_config:
      aws:
        access_key_id: "eVpT4jOcgK2mkOGA"
        bucketnames: loki-chunks
        endpoint: minio.storage.svc.cluster.local:9000
        insecure: true
        s3forcepathstyle: true
        secret_access_key: "8vaeCrnvc6hCZ3ApKyh5534zBNMp0qC7"
      tsdb_shipper:
        active_index_directory: /var/loki/tsdb-index
        cache_location: /var/loki/tsdb-cache
        shared_store: s3
  storage:
    bucketNames:
      chunks: "loki-chunks"
      # ruler: "loki-ruler" # Uncomment and set if you use ruler with S3
      # admin: "loki-admin" # Uncomment and set if you use admin with S3
    type: s3
  # storage:
  #   bucketNames:
  #     chunks: "loki-chunks"

deploymentMode: SingleBinary

singleBinary:
  replicas: 1

backend:
  replicas: 0

# gateway:
#   enabled: false # Disable gateway and Ingress
#   ingress:
#     annotations:
#       cert-manager.io/cluster-issuer: "letsencrypt-production"
#     enabled: false # Ingress is not used when gateway is disabled
#     hosts:
#       - host: loki.wakkalabs.com
#         paths:
#           - path: /
#             pathType: Prefix
#     ingressClassName: "internal" # Common practice for specifying ingress class
#     tls:
#       - hosts:
#           - loki.wakkalabs.com
#         secretName: loki-tls

minio:
  enabled: false

read:
  replicas: 0

# This service block configures the main Loki service (for singleBinary pods).
# If using Ingress via the gateway, this service typically can be ClusterIP.
# Exposing it as LoadBalancer on port 443 (to HTTP 3100) is redundant if Ingress is used
# and might be misconfigured for TLS if the LB doesn't terminate.
# Consider changing to ClusterIP or adjusting ports if LB is truly desired alongside Ingress.
service:
  port: 3100       # Expose Loki's HTTP port internally
  targetPort: 3100
  type: ClusterIP # Changed from LoadBalancer assuming Ingress is primary

write:
  replicas: 0
